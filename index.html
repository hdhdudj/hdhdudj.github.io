<meta charset="utf-8">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.7.7/xlsx.core.min.js"></script>  
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
    <script src="http://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xls/0.7.4-a/xls.core.min.js"></script> 
    <style>
        th,td{
            padding:10px;
        }
        .phonenum{
            width: 40px;
        }
    </style>
    <script>
        function nextBlank(N, Obj, nextId){
            if(document.getElementById(Obj).value.length == N){
                document.getElementById(nextId).focus();
            }
        }
        function formCheck(form) {
        form.name.value = form.name.value.trim();
        if (form.name.value.length == 0) {
            alert('이름을 입력해주세요.');
            form.name.focus();
            return;
        }
        
        form.phonenum1.value = form.phonenum1.value.trim();
        if (form.phonenum1.value.length == 0) {
            alert('번호를 입력해주세요.');
            form.phonenum1.focus();
            return;
        }
        form.phonenum2.value = form.phonenum2.value.trim();
        if (form.phonenum2.value.length == 0) {
            alert('번호를 입력해주세요.');
            form.phonenum2.focus();
            return;
        }
        form.phonenum3.value = form.phonenum3.value.trim();
        if (form.phonenum3.value.length == 0) {
            alert('번호를 입력해주세요.');
            form.phonenum3.focus();
            return;
        }
        getNum();
    }
    function getNum(){
        var url = "/testt.xlsx";
        var oReq = new XMLHttpRequest();
        oReq.open("GET", url, true);
        oReq.responseType = "arraybuffer";

        oReq.onload = function (e) {
        var arraybuffer = oReq.response;

        /* convert data to binary string */
        var data = new Uint8Array(arraybuffer);
        var arr = new Array();
        for (var i = 0; i != data.length; ++i) arr[i] = String.fromCharCode(data[i]);
        var bstr = arr.join("");

        /* Call XLSX */
        var workbook = XLSX.read(bstr, {
            type: "binary"
        });

        /* DO SOMETHING WITH workbook HERE */

        var first_sheet_name = workbook.SheetNames[0];
        var address_of_cell = 'A1';

        /* Get worksheet */
        var worksheet = workbook.Sheets[first_sheet_name];

        /* Find desired cell */
        var desired_cell = worksheet[address_of_cell];

        /* Get the value */
        var desired_value = desired_cell.v;

        $('.asdf').append('<div>'+desired_value+'</div>');
    }

        oReq.send();
    }
    </script>
</head>
<body>
    <h1>테스트</h1>
    <a href="/testt.xlsx">테스트용 엑셀파일</a>
    <form onsubmit="formCheck(this); return false;">
    <table>
        <tr>
            <th>이름</th>
            <td><input type="text" name="name" placeholder="이름을 입력하세요."></td>
        </tr>
        <tr>
            <th>휴대폰 번호</th>
            <td><input type="text" name="phonenum1" class="phonenum" id="pN1" onkeyup="nextBlank(3,this.id,'pN2');"> <input type="text" name="phonenum2" class="phonenum" id="pN2" onkeyup="nextBlank(4,this.id,'pN3');"> <input type="text" name="phonenum3" class="phonenum" id="pN3"></td>
        </tr>
        <tr>
            <th></th>
            <td><button type="submit">등기번호 가져오기</button> <input type="reset" value="리셋"></td>
        </tr>
    </table>
    </form>
    <div class="asdf"></div>
    <img src="http://cfile219.uf.daum.net/image/9901BC475D330A9C201818"/>
</body>
